<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">

<properties>

<!-- 주문내역 리스트 조회 중 갯수 조회용 쿼리문 / 2023-04-24 김서영 -->
	<entry key="selectListCount">
		SELECT COUNT(ORDER_NO) CNT
		  FROM ORDERS
		 WHERE MEMBER_NO = ?
	</entry>


<!-- 주문내역 리스트 가져오기 쿼리문 / 2023-04-24 김서영 -->
	<entry key="selectList">
		SELECT ORDER_NO
	         , ORDER_STATUS
	         , ORDER_DATE
	         , LISTAGG(ITEM_NAME, ', ') WITHIN GROUP (ORDER BY ITEM_NAME) AS ITEM_LIST
	         , SUM(ROUND(ITEM_PRICE * (1-ITEM_DISCOUNT), -1) * ORDER_ITEM) AS TOTAL_PRICE
	  	  FROM ORDERS
		  JOIN ITEM_LIST USING (ORDER_NO)
		  JOIN ITEM USING (ITEM_CODE)
		 WHERE MEMBER_NO = ?
		 GROUP BY ORDER_NO, ORDER_STATUS, ORDER_DATE
	</entry>


<!-- 가장 비싼 아이템의 사진 불러오기 쿼리문 / 2023-04-24 김서영 -->
	<entry key="maxImgSelect">
		 SELECT MAX(PRICE) AS MAX_PRICE
		      , MAX(ITEM_IMG_PATH) AS ITEM_IMG_PATH
		   FROM ITEM_LIST
		   JOIN ITEM_IMG ON ITEM_CODE = ITEM_IMG_CODE
		   JOIN ITEM ON ITEM_LIST.ITEM_CODE = ITEM.ITEM_CODE
		   JOIN ORDERS O USING (ORDER_NO)
		  WHERE O.MEMBER_NO = ?
	</entry>


</properties>